{"pageProps":{"posts":[{"slug":"measures-of-location","frontmatter":{"title":"Measures of Location","description":"Use average, mean, median and more measures to understand basic investing.","date":"October 18, 2020","tags":[{"id":"python","name":"python","image":"automation.jpg","description":"Python","color":"bg-green-300","icon":"python.svg"}],"topic":{"id":"mathematics","name":"Mathematics","image":"mathematics.jpeg","description":"Investing as part of the Science of Finance is subject to the lows of Mathematics!","color":"bg-green-300"},"author":{"id":"chris","name":"Chris","image":"https://s.gravatar.com/avatar/db809ecfa64d56da4bd9704c8393005a?s=80","description":"Software Engineer, passionate about ..."},"img":"https://www.picpedia.org/highway-signs/images/average.jpg"},"excerpt":"","content":"\nIn investing, we are often presented with the challenge to analyze a data set. Usually a graph of how a stock, a fund, etc. performs. \n\nWe are asked to answer questions like:\n\n* What is the average return of a stock the last x days (given the daily returns)?\n* What is the return of a stock that occurred the most the last x days?\n* etc. \n\nTo answer, we commonly start by exploring some attributes that best describe the data. We often call them [`Measures of Location`](https://www.encyclopedia.com/computing/dictionaries-thesauruses-pictures-and-press-releases/measures-location).\n\nThe most common measures of location are the Mean, Median and Mode.\n\n### Mean (or **average**) and Root Mean Square (RMS)\n\nMean is the sum of the values of the data points divided by the number of data points. That is,\n\n$$ \n\\bar{Y} = \\frac {\\sum_{i=1}^N Y_{i}}{N},\n$$\n\nBut, what if we have a sequence like `0\t4\t1\t-4\t-1`? The Mean will be 0! In that case we reside to the RMS which is \n\n$$\n\\bar{Y}_{rms} = \\sqrt \\frac {\\sum_{i=1}^N Y_{i}^2}{N},\n$$\n\n### Median\n\nIs the value of the point which has half the data smaller than that point and half the data larger than that point.\n\n$$\n\\tilde{Y} = Y_{\\frac {N+1}{2}}, \\text{if } N = odd\n$$\n\n$$\n\\tilde{Y} = \\frac {Y_{\\frac {N}{2}} + Y_{\\frac {N}{2} + 1}}{2}, \\text{if } N = even\n$$\n\n### Mode\n\nIs the value of the random sample that occurs with the greatest frequency (might not be unique).\n\n## Example\n\nLet us generate some random data to showcase the above. We use `random.normal` here, which generates normally distributed numbers (we will discuss about normality in a following article) between -10 and 10. In terms of Investing, think of it as the simple returns of a stock over a period.\n\n\n\n```\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set() \n\nrandomInts = np.random.normal(loc=10, scale=3, size=1000).astype(int)-10\n\ndf = pd.DataFrame(randomInts, columns=['Returns'])\ndf.plot();\n\n```\n\n\n    \n![png](measures-of-location_3_0.png)\n    \n\n\n### Mean\n\n\n```\ndf.Returns.sum()/df.Returns.size\n```\n\n\n\n\n    -0.612\n\n\n\n\n```\n# or\nmean = df.Returns.mean()\nmean\n```\n\n\n\n\n    -0.612\n\n\n\nWhich is the answer to: `What is the average return of a stock the last x days?`\n\n### Median\n\n\n```\nnp.sort(df.Returns.values)[int(df.Returns.size/2)]\n```\n\n\n\n\n    -1\n\n\n\n\n```\n# or\nmedian = np.percentile(df.Returns,50)\nmedian\n```\n\n\n\n\n    -1.0\n\n\n\n### Mode\n\n\n```\nsample_data = [1,2,3,4,3,5,3,6,3,7,8,9]\nsample_data_df = pd.DataFrame(sample_data, columns=['Returns'])\nsample_data_df.Returns.mode()[0]\n```\n\n\n\n\n    3\n\n\n\nIt is apparent from the above that the number with the most frequent appearance is the number 3. That is because the numbers are discrete.\n\nBut, in a sequence of data that is continuous, the numbers can take any value in a range, which means decimal part (fractions). In cases like that it is difficult to find a single number that is present more often in the set. And that is normally the case in investing (the returns can take any value). Thus, we have to follow another approach and that is to separate the data into buckets. Here is where the notion of the [histogram](https://en.wikipedia.org/wiki/Histogram) comes into play and generates an outcome like:\n\n\n```\ndf.plot.hist(bins=50, figsize=(12,6), grid=True);\n```\n\n\n    \n![png](measures-of-location_14_0.png)\n    \n\n\nWhat really happens is to order the values in ascending order and then separate them in a number of buckets. For example if the min value is 1 and the max 10 and we split them in 9 buckets, the first one will include all numbers from 1 to 2, the second all numbers from 2 to 3 and so on. The next step is to find the bucket with the highest amount of elements and take the middle value.  \n\n\n```\ncounts, bins = np.histogram(df.Returns, bins=50)\nmax_index_col = np.argmax(counts, axis=0)\nmode = bins[max_index_col]\nmode\n```\n\n\n\n\n    -1.0\n\n\n\n\n```\n# or\ndf.Returns.mode()[0]\n```\n\n\n\n\n    -1\n\n\n\n## Alternative Measures of Location\n\n* Mid-Mean - computes a mean using the data between the 25th and 75th percentiles.\n\n* Trimmed Mean - similar to the mid-mean except different percentile values are used. A common choice is to trim 5% of the points in both the lower and upper tails, i.e., calculate the mean for data between the 5th and 95th percentiles.\n\n* Winsorized Mean - similar to the trimmed mean. However, instead of trimming the points, they are set to the lowest (or highest) value. For example, all data below the 5th percentile are set equal to the value of the 5th percentile and all data greater than the 95th percentile are set equal to the 95th percentile.\n\n* Mid-range = (largest + smallest)/2.\n\n### Mid-Mean\n\n\n```\n# p_25 = df.Returns.quantile(0.25)  # Much slower than np.percentile\np_25 = np.percentile(df.Returns,25) # attention : the percentile is given in percent (5 = 5%)\np_75 = np.percentile(df.Returns,75)\nmid_mean = df[df.Returns.gt(p_25) & df.Returns.lt(p_75)].Returns.mean()\nmid_mean\n```\n\n\n\n\n    -1.010498687664042\n\n\n\n### Trimmed-Mean\n\n\n```\np_5 = np.percentile(df.Returns,5)\np_95 = np.percentile(df.Returns,95)\ntrimmed_mean = df[df.Returns.gt(p_5) & df.Returns.lt(p_95)].Returns.mean()\ntrimmed_mean\n```\n\n\n\n\n    -0.5480427046263345\n\n\n\n\n### Winsorized Mean\n\n\n```\ndata_indexes_to_stay_same = ( df.Returns > p_5 ) & ( df.Returns < p_95 )\ndata_to_stay_same = df[data_indexes_to_stay_same]\nall_data_bellow_p_5 = df[df.Returns <= p_5].copy()\nall_data_bellow_p_5.Returns.values[:] = p_5\nall_data_above_p_95 = df[df.Returns >= p_95].copy()\nall_data_above_p_95.Returns.values[:] = p_95\nwinsored_rets_list = [all_data_bellow_p_5, data_to_stay_same, all_data_above_p_95]\nwinsored_rets = pd.concat(winsored_rets_list)\nwinsored_mean = winsored_rets.Returns.mean()\nwinsored_mean\n```\n\n\n\n\n    -0.608\n\n\n\n### Mid-range\n\n\n```\nmid_range = (df.Returns.max() + df.Returns.min())/2\nmid_range\n```\n\n\n\n\n    -1.0\n\n\n\n#### All Together\n\n\n```\n# df.Returns.plot.hist(bins=200, figsize=(15,6), grid=True)\nplt.figure(figsize=(15,6))\nsns.histplot(df.Returns, kde=True, bins=100)\nplt.title(\"Measures of Location\")\nplt.xlabel(\"Utv\", labelpad=20, weight='bold', size=12)\nplt.ylabel(\"# of Utv in a bin\", labelpad=20, weight='bold', size=12)\nplt.axvline(x=mid_range, label='mid_range={:.3f}'.format(mid_range), ymax=0.95, c=np.random.rand(3,))\nplt.axvline(x=mean, label='mean={:.3f}'.format(mean), ymax=0.95, c=np.random.rand(3,))\nplt.axvline(x=median, label='median={:.3f}'.format(median), ymax=0.95, c=np.random.rand(3,))\nplt.axvline(x=mode, label='mode={:.3f}'.format(mode), ymax=0.95, c=np.random.rand(3,))\nplt.axvline(x=mid_mean, label='mid_mean={:.3f}'.format(mid_mean), ymax=0.95, c=np.random.rand(3,))\nplt.axvline(x=winsored_mean, label='winsored_mean={:.3f}'.format(winsored_mean), ymax=0.95, c=np.random.rand(3,))\nplt.axvline(x=trimmed_mean, label='trimmed_mean={:.3f}'.format(trimmed_mean), ymax=0.95, c=np.random.rand(3,))\nplt.gca().legend(loc=\"upper left\")\nplt.show()\n```\n\n\n    \n![png](measures-of-location_28_0.png)\n    \n\n"}],"tags":[{"id":"python","name":"python","image":"automation.jpg","description":"Python","color":"bg-green-300","icon":"python.svg","slug":"python","count":1}],"sortedTopics":[{"id":"mathematics","name":"Mathematics","image":"mathematics.jpeg","description":"Investing as part of the Science of Finance is subject to the lows of Mathematics!","color":"bg-green-300","slug":"mathematics","count":1}],"allTopics":[{"id":"mathematics","name":"Mathematics","image":"mathematics.jpeg","description":"Investing as part of the Science of Finance is subject to the lows of Mathematics!","color":"bg-green-300"}]},"__N_SSG":true}